# Autoinstall configuration
autoinstall:
  version: 1

  # Storage configuration with LVM
  storage:
    layout:
      name: lvm

  # Kernel override
  kernel:
    package: linux-server

  # Language, locale, and timezone settings
  locale:
    language: en_US
    country: US
    timezone: UTC

  # Network configuration
  network:
    version: 2
    ethernets:
      eth0:
        dhcp4: true

  # Hostname
  system:
    hostname: ona-default

  # Package installation
  packages:
    include:
      - apt-transport-https
      - iptables-persistent
      - ipset
      - libjansson4
      - libltdl7
      - liblzo2-2
      - libnet1
      - libyaml-0-2
      - nano
      - ntp
      - ntpdate
      - python2.7
      - snmp
      - tcpdump

  # Tasksel
  tasks:
    - server

  # Custom configuration scripts
  late_commands:
    - cp -r /cdrom/ona/ /target/root/
    - chroot /target chmod +x /root/ona/configure.sh
    - chroot /target bash /root/ona/configure.sh

  # System settings
  debconf:
    quiet: false
    splash: false
    pkgsel:
      install_language_support: false

  # GRUB timeout
  grub:
    timeout: 2

  # iptables-persistent settings
  early_commands:
    - echo 'iptables-persistent iptables-persistent/autosave_v6 boolean false' | debconf-set-selections
    - echo 'iptables-persistent iptables-persistent/autosave_v4 boolean false' | debconf-set-selections

  # OEM configuration
  oem-config:
    steps:
      - language
      - timezone
      - keyboard
      - user
      - network
      - tasks 
