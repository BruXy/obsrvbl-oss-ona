#cloud-config
# https://ubuntu.com/server/docs/install/autoinstall-reference
autoinstall:
  version: 1

  storage:
    layout:
      name: lvm

  network:
    version: 2
    ethernets:
      enp0s3:
        dhcp4: true

  identity:
    realname: 'Ubuntu ONA User'
    username: ona-ubuntu
    password: '$y$j9T$vTPss2y8DIwI64Qhspa2u1$0WErBalivR6wnQ82NIMmjzQDEEr7m6vfsESbVLzgwa1'
    hostname: ona-default

  locale: en_US.UTF-8
  timezone: UTC

  ssh:
    install-server: true

  # iptables-persistent settings
  early-commands:
    - echo 'iptables-persistent iptables-persistent/autosave_v6 boolean false' | debconf-set-selections
    - echo 'iptables-persistent iptables-persistent/autosave_v4 boolean false' | debconf-set-selections

  packages:
    - apt-transport-https
    - iptables-persistent
    - ipset
    - libjansson4
    - libltdl7
    - liblzo2-2
    - libnet1
    - libyaml-0-2
    - nano
    - ntp
    - ntpdate
    - snmp
    - tcpdump
    - net-tools

  late-commands:
    - cp -r /cdrom/ona/ /target/root/
    - curtin in-target --target=/target -- bash -xv /root/ona/configure.sh
